fragment VoucherGroup on VoucherGroup {
  id
  projectId
  codeLength
  currency
}

query findVoucherByCode($code: String! $currency: String! $projectId: uuid!) {
  voucher(where: {code: {_eq: $code} isArchived: {_eq: false} balance: {_neq: 0}  projectId: {_eq: $projectId}}) @firstOrFail {
    balance
    id
  }
}

mutation insertVouchers($input: [VoucherInsertInput!]!) {
  insertVoucher(objects: $input) {
    affected_rows
  }
}
query getVoucherGroup($id: uuid! $projectId: uuid!) {
  voucherGroup(where: {id: {_eq: $id} projectId: {_eq: $projectId}}) @firstOrFail {
    ...VoucherGroup
  }
}