fragment Refund on Refund {
  id
  paymentId
  amount
  status
  orderCurrencyAmount
}

query getRefundById ($id: uuid!) {
  refundByPk(id: $id) {
    ...Refund
  }
}

query getRefundByIdWithPayment ($id: uuid!) {
  refundByPk(id: $id) @nonNullable {
    ...Refund
    payment {
      ...PaymentMinimal
    }
  }
}

mutation updateRefundById ($id: uuid! $input: RefundSetInput!) {
  updateRefundByPk(pk_columns: {id: $id}, _set: $input) {
    ...Refund
  }
}

mutation createRefund($input: RefundInsertInput!) {
  insertRefundOne(object: $input) @nonNullable {
    ...Refund
  }
}

query findPendingRefundByPaymentId($paymentId: uuid!) {
  refund(where: {paymentId: {_eq: $paymentId} status: {_eq: PENDING}} limit: 1) @first {
    id
  }
}
query findPendingRefundByOrderId($orderId: uuid!) {
  refund(where: {payment: {orderId: {_eq: $orderId}} status: {_eq: PENDING}} limit: 1) @first {
    id
  }
}